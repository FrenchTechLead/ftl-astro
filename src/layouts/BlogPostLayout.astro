---
import MetaHead from "@comps/MetaHead.astro";
import Header from "@comps/Header.astro";
import Footer from "@comps/Footer.astro";
import Styles from "@comps/styles/Styles.astro";
import BlogPost from "@comps/BlogPost.astro";
import Image from "@comps/Image.astro";
import Separator from "@comps/Separator.jsx";
import Sponsor from "@comps/Sponsor.astro";
import AuthorCard from "@comps/AuthorCard";
import {
  getFileName,
  getPublishDateStrFromFileName,
  buildURL,
} from "@utils/utils";
import type { Frontmatter } from "@models/fontmatter";

const fm = Astro.props.content as Frontmatter;

const FILE_NAME = getFileName(Astro);
const PATH_NAME = Astro.url.pathname;
const PUBLISH_DATE = getPublishDateStrFromFileName(FILE_NAME);
const PERMALINK = await buildURL(Astro.url.pathname);
const IMG_SRC = await buildURL("/assets/blog/tech/" + FILE_NAME + "/0.png");
---

<!DOCTYPE html>
<html lang={fm.lang} data-bs-theme="dark">
  <head>
    <MetaHead frontmatter={fm} permalink={PERMALINK} imgSrc={IMG_SRC} />
    <Styles />
  </head>
  <body>
    <Header />
    <BlogPost title={fm.title} publishDate={PUBLISH_DATE}>
      <AuthorCard id="akram_mecheri" lang={fm.lang} />
      {(<Image w={842} h={462} src={IMG_SRC} t={fm.title} />)}
      <slot />
      <Separator />
    </BlogPost>
    <Separator />
    <Sponsor />
    <script
      src="https://utteranc.es/client.js"
      repo="FrenchTechLead/ftl-astro"
      issue-term={PATH_NAME}
      theme="gruvbox-dark"
      crossorigin="anonymous"
      async
    ></script>
    <Footer />
  </body>
</html>
